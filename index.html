<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MSMS | Secret Encode-Decode</title>
  <style>
    body {
      background-color: #121212;
      color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    h1 {
      color: #00ffcc;
      font-size: 24px;
      margin-bottom: 10px;
    }

    textarea {
      width: 90%;
      max-width: 600px;
      height: 120px;
      margin: 10px 0;
      padding: 10px;
      font-size: 16px;
      background-color: #1e1e1e;
      color: #ffffff;
      border: 1px solid #333;
      border-radius: 8px;
      resize: vertical;
      overflow: auto;
    }

    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      background-color: #00ffcc;
      color: #000000;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #00ccaa;
    }

    .copy-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    .status {
      margin-top: 10px;
      color: #00ffcc;
      font-size: 14px;
      height: 18px;
    }
  </style>
</head>
<body>
  <h1>MSMS Secret Signal System</h1>

  <textarea id="inputText" placeholder="এখানে লিখুন..."></textarea>
  <div class="copy-buttons">
    <button onclick="detectAndTranslate()">Ncode / Dcode</button>
    <button onclick="copyText('input')">A</button>
    <button onclick="copyText('output')">B</button>
  </div>
  <textarea id="outputText" placeholder="ফলাফল এখানে দেখাবে..." readonly></textarea>
  <div class="status" id="statusMsg"></div>

  <script>
    const mapAtoB = {
    "A": "37444", "B": "53656", "C": "47565", "D": "56565", "E": "65810", "F": "79521", "G": "50454", "H": "91162", "I": "64503", "J": "83631", "K": "25530", "L": "38508", "M": "71655", "N": "84566", "O": "92230", "P": "66677", "Q": "31699", "R": "42805", "S": "76464", "T": "18765", "U": "33600", "V": "27686", "W": "96481", "X": "55660", "Y": "81517", "Z": "66934",
      "a": "16652", "b": "90550", "c": "34465", "d": "29590", "e": "61411", "f": "72418", "g": "58480", "h": "40253", "i": "10352", "j": "39560", "k": "25567", "l": "37437", "m": "70577", "n": "80152", "o": "95410", "p": "19951", "q": "32842", "r": "46599", "s": "57858", "t": "18574", "u": "20520", "v": "43543", "w": "61566", "x": "55001", "y": "74620", "z": "68366",
      "অ": "00555", "আ": "20065", "ই": "47646", "ঈ": "55886", "উ": "91632", "ঊ": "72699", "ঋ": "35371", "এ": "86215", "ঐ": "64682", "ও": "10647", "ঔ": "26873",
      "ক": "52471", "খ": "84550", "গ": "90413", "ঘ": "62588", "ঙ": "33260", "চ": "19544", "ছ": "78622", "জ": "50581", "ঝ": "26207", "ঞ": "15663", "ট": "33565", "ঠ": "68600", "ড": "22767", "ঢ": "59613", "ণ": "83352", "ত": "46521", "থ": "71363", "দ": "95908", "ধ": "13459", "ন": "26561", "প": "37504", "ফ": "55657", "ব": "28582", "ভ": "74551", "ম": "86509", "য": "42502", "র": "10598", "ল": "50634", "শ": "61686", "ষ": "75690", "স": "68462", "হ": "89699", "ড়": "31540", "ঢ়": "28690", "য়": "47563", "ৎ": "10677", "ং": "33501", "ঃ": "22602", "ঁ": "46866", "ঽ": "91655",
      "া": "56255", "ি": "55664", "ী": "56536", "ু": "57463", "ূ": "35566", "ৃ": "24784", "্": "27783", "্য": "36633",
      "0": "!£+!/", "1": "&{\"/", "2": "/#'&/", "3": "%*'/!", "4": "/£'+/", "5": "/$-£/", "6": "'<+%", "7": "|*>&", "8": "/!<|%", "9": "{:/&",
      "~": "26427", "`": "32552", "|": "43683", "√": "73401", "π": "62218", "÷": "70992", "×": "81634", "}": "21309", "{": "87144", "£": "58432", "$": "94501", "℅": "75209", "^": "68213", "°": "39012", "•": "17734", "_": "13481", "=": "80800", "]": "94103", "[": "41076", "®": "67334", "©": "81291", "™": "55791", "\\": "72290", "<": "39884", ",": "54662", ".": "26372", "@": "73929", "#": "19120", "৳": "84255", "%": "36930", "&": "61209", "*": "20808", "-": "70442", "+": "18674", ")": "98521", "(": "34699", "!": "49217", "\"": "71380", "'": "62503", ":": "58066", ";": "70291", "/": "83110", "?": "94041", "★": "78551", "Π": "47180", "←": "69205", "↑": "51149", "↓": "97441", "→": "62402", "§": "82580", "¢": "26566", "∞": "13153", "∆": "54510", "∑": "46634", "∫": "51250", "±": "37450", "≈": "68502", "∅": "90581", "∈": "71491", "∉": "92752", "∩": "26660", "∪": "13643", "⊂": "85150", "⊆": "11582", "⊄": "77451", "∝": "42642"
    };

    const mapBtoA = Object.fromEntries(Object.entries(mapAtoB).map(([k, v]) => [v, k]));

    function detectAndTranslate() {
      const input = document.getElementById('inputText').value.trim();
      const outputText = document.getElementById('outputText');
      const statusMsg = document.getElementById('statusMsg');

      if (!input) {
        outputText.value = "";
        statusMsg.textContent = "ইনপুট খালি!";
        return;
      }

      // Determine type by majority
      const tokens = input.split(/(\s+|x\d+|y\d+|z\d+|w\d+|v\d+|u\d+|\d+)/g).filter(t => t.trim() !== "");
      let bCount = 0;
      let aCount = 0;
      for (const t of tokens) {
        if (mapBtoA[t]) bCount++;
        else if (mapAtoB[t]) aCount++;
      }

      const isEncoded = bCount >= aCount;

      let result = "";
      if (isEncoded) {
        const matches = input.match(/x\d+|y\d+|z\d+|w\d+|v\d+|u\d+|\d+|[a-zA-Z_]/g);
        if (matches) {
          for (let char of matches) {
            result += mapBtoA[char] || char;
          }
        } else {
          result = "ডিকোড করতে ব্যর্থ!";
        }
        statusMsg.textContent = "Decoded (B → A)";
      } else {
        for (let char of input) {
          result += mapAtoB[char] || char;
        }
        statusMsg.textContent = "Encoded (A → B)";
      }

      outputText.value = result;
    }

function copyText(type) {
  const inputEl = document.getElementById('inputText');
  const outputEl = document.getElementById('outputText');
  const statusEl = document.getElementById('statusMsg');

  const text = type === 'input' ? inputEl?.value : outputEl?.value;
  if (!text) {
    statusEl.textContent = "কিছু কপি করার মতো নেই!";
    return;
  }

  if (navigator.clipboard && window.isSecureContext) {
    navigator.clipboard.writeText(text).then(() => {
      statusEl.textContent = `${type === 'input' ? 'A' : 'B'} কপি হয়েছে!`;
    }).catch(() => {
      fallbackCopy(text, type);
    });
  } else {
    fallbackCopy(text, type);
  }
}

function fallbackCopy(text, type) {
  const statusEl = document.getElementById('statusMsg');
  const temp = document.createElement('textarea');
  temp.value = text;
  temp.style.position = 'fixed';
  temp.style.opacity = '0';
  document.body.appendChild(temp);
  temp.select();

  try {
    const successful = document.execCommand('copy');
    statusEl.textContent = successful
      ? `${type === 'input' ? 'A' : 'B'} কপি হয়েছে!`
      : "কপি করা যায়নি!";
  } catch (err) {
    statusEl.textContent = "কপি করা যায়নি!";
  }

  document.body.removeChild(temp);
}  
  </script>
</body>
</html>
